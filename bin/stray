#!/bin/bash
set -e

#Add the following lines to your shell initializing script (i.e. .bashrc or .bash_profile etc)
#export STRAY_PATH=<absolute_path_to_stray_source>
#export PATH="$STRAY_PATH/CLI/bin:$PATH"

if [ "$1" = "generate" ]
then
    if [ $# != 3 ]
    then
        echo "Not enough arguments supplied"
        exit 1
    fi

    if [ "$2" = "keypoints" ]
    then
        python3 $STRAY_PATH/Labeling/labeling/generate.py $3 --keypoints --generate-images
    elif [ "$2" = "bbox_2d" ]
    then
        python3 $STRAY_PATH/Labeling/labeling/generate.py $3 --bbox_2d --generate-images
    elif [ "$2" = "semantic" ]
    then
        shift 2
        stray-segment $@
    else
        echo "Bad primitive type"
    fi

elif [ "$1" = "studio" ]
then
    if [ $# != 3 ]
    then
        echo "Usage: stray studio open/integrate <path-to-scene>"
        exit 1
    fi

    scene_dir=$3
    if [ ! -d "$scene_dir" ]; then
        echo "data directory does not exist: $scene_dir"
        exit 1
    fi

    if [ "$2" = "integrate" ]
    then
        docker run -it -v $scene_dir:/root/data orbslam
    elif [ "$2" = "open" ]
    then
        studio $scene_dir
    fi

else
    echo "No command supplied"
fi

